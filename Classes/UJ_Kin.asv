classdef UJ_Kin
    %UJ_Kin This class generates the 
    %   Detailed explanation goes here
    
    properties
        VDefs
        r0s
        Theta_d_gam
        Theta_d_beta
        Omega2ms
        Omega2vs
        Omega_p
        v2s
        a0s
        a2s
    end
   
    
    methods
        function obj = UJ_Kin(Var_Defs)
            %UNTITLED Construct an instance of this class
            %   Detailed explanation goes here
            
            
            %Assign the Var_Defs object that was in the constructor argument to the
            %classes VDefs property
%             obj.VDefs = Var_Defs;
            
            % Extract out variables from Var_Defs that will be used in this context. Just
            % trying to shorten the code that utilizes the variables. 
            t = Var_Defs.t;
            R20 = Var_Defs.R20;
            R02 = Var_Defs.R02;
            R12 = Var_Defs.R12;
            R12d = Var_Defs.R12d;
            R21 = Var_Defs.R21;
            R01d = Var_Defs.R01d;
            R10 = Var_Defs.R10;
            
            r2s = Var_Defs.r2s;
            Omega2
            
            %Derive r0s, the arbitrary displacement vector originally defined in frame S2,
            %rotated into the S0 basis
            obj.r0s = R20*r2s;
            
            %Get the Theta_d_gam matrix by multiplying R12d by R21. R12d = Theta_D_gam*R12
            %and therefore R21 anihilates with R12.  
            obj.Theta_d_gam = simplify(R12d*R21); %shows that if this is Theta_d_12 then Theta_d_12*R12 = R12d
            
            %Get the Theta_d_beta matrix by multiplying R01d by R10. R01d =
            %Theta_D_gam*R01 and therefore R10 anihilates with R01.  
            obj.Theta_d_beta = simplify(R01d*R10);
            
            %Derive the global angular velocity matrix of the plate frame in terms of beta
            %and gamma. This matrix has components expresseed in the S2 basis, the plate
            %frame. 
            obj.Omega2ms = simplify((obj.Theta_d_gam + R12*obj.Theta_d_beta*R21).');
            
            %Extract the components of Omega2ms associated with Omega2vs, the vector
            %representation of the same information. 
            obj.Omega2vs = obj.VDefs.Omega2vs; %This makes a copy of the variable defined in VDefs.
            %This class will utilize the definition but create and alter its own copy of the variable. 
            obj.Omega2vs(1) = obj.Omega2ms(3,2); 
            obj.Omega2vs(2) = obj.Omega2ms(1,3);
            obj.Omega2vs(3) = obj.Omega2ms(2,1);
            
            %Derive the global velocity vector of an arbitrary displacement within frame
            %S2 written in the S2 basis. 
            obj.v2s =  diff(obj.VDefs.r2s,t) + obj.Omega2ms*obj.VDefs.r2s; 
            
            %Derive the global acceleration vector of an arbitrary displacement within frame
            %S2 written in the S2 basis. 
            obj.a0s = diff(R20*obj.v2s,t);
            obj.a2s = simplify(R02*obj.a0s);
        end
    end
end

